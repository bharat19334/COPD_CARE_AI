<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COPD Care AI - Doctor Search</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Leaflet (OpenStreetMap) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <style>
        * {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: #f3f4f6;
            overflow-x: hidden;
        }
        
        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, #ffffff 0%, #fafafa 100%);
            border-right: 1px solid rgba(0,0,0,0.05);
            box-shadow: 4px 0 20px rgba(0,0,0,0.02);
        }
        
        .sidebar-item {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 12px;
            margin: 4px 12px;
        }
        
        .sidebar-item:hover {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            transform: translateX(5px);
            box-shadow: 0 10px 20px -10px rgba(59,130,246,0.5);
        }
        
        .sidebar-item.active {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            box-shadow: 0 10px 20px -10px rgba(59,130,246,0.5);
        }
        
        .sidebar-item i {
            width: 24px;
            font-size: 1.1rem;
        }
        
        /* Map Container */
        #doctorMap {
            height: 500px;
            width: 100%;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            z-index: 1;
        }
        
        #doctorMap:hover {
            box-shadow: 0 8px 30px rgba(59,130,246,0.15);
        }
        
        /* Doctor Cards */
        .doctor-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(0,0,0,0.03);
            position: relative;
            overflow: hidden;
        }
        
        .doctor-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .doctor-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 30px -10px rgba(59,130,246,0.2);
            border-color: transparent;
        }
        
        .doctor-card:hover::before {
            transform: scaleX(1);
        }
        
        .doctor-avatar {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #dbeafe 0%, #ede9fe 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid white;
            box-shadow: 0 4px 10px rgba(59,130,246,0.2);
        }
        
        /* Custom Scrollbar */
        #doctorList::-webkit-scrollbar {
            width: 6px;
        }
        
        #doctorList::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        #doctorList::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            border-radius: 10px;
        }
        
        #doctorList::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%);
        }
        
        /* Filter Section */
        .filter-input {
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .filter-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59,130,246,0.1);
            outline: none;
        }
        
        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(59,130,246,0.3);
            border-radius: 50%;
            border-top-color: #3b82f6;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Responsive Design */
        @media (max-width: 1024px) {
            .sidebar {
                width: 80px;
            }
            .sidebar span {
                display: none;
            }
            .sidebar .user-info {
                display: none;
            }
            .ml-64 {
                margin-left: 80px;
            }
        }
        
        @media (max-width: 768px) {
            .grid-cols-3 {
                grid-template-columns: 1fr;
            }
        }
        
        /* Buttons */
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            padding: 10px 24px;
            border-radius: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(59,130,246,0.5);
        }
        
        .btn-primary:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background: white;
            color: #3b82f6;
            border: 2px solid #3b82f6;
            padding: 8px 20px;
            border-radius: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .btn-secondary:hover {
            background: #3b82f6;
            color: white;
        }
    </style>
</head>
<body>
    <div class="flex h-screen">
        <!-- ==================== SIDEBAR ==================== -->
        <div class="sidebar fixed h-full z-10">
            <div class="p-6">
                <!-- Logo -->
                <div class="flex items-center space-x-3 mb-8">
                    <div class="w-12 h-12 bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-lungs text-white text-xl"></i>
                    </div>
                    <div>
                        <span class="text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">COPD Care</span>
                        <span class="text-xs font-medium text-blue-600 block">AI</span>
                    </div>
                </div>
                
                <!-- User Info -->
                <div class="user-info flex items-center space-x-3 mb-6 p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl">
                    <div class="w-12 h-12 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-lg shadow-md">
                        BG
                    </div>
                    <div>
                        <div class="font-semibold text-gray-800" id="userName">Bharat Goswami</div>
                        <div class="text-xs text-gray-500 flex items-center">
                            <i class="fas fa-circle text-green-500 text-[8px] mr-1"></i> Patient
                        </div>
                    </div>
                </div>
                
                <!-- Navigation -->
                <nav class="space-y-1">
                    <a href="dashboard.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 text-gray-700">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </a>
                    <a href="prediction.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 text-gray-700">
                        <i class="fas fa-robot"></i>
                        <span>COPD Prediction</span>
                    </a>
                    <a href="diet-plan.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 text-gray-700">
                        <i class="fas fa-utensils"></i>
                        <span>My Diet Plan</span>
                    </a>
                    <a href="#" class="sidebar-item active flex items-center space-x-3 px-4 py-3">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>Doctor Search</span>
                    </a>
                    <a href="whatsapp-agent.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 text-gray-700">
                        <i class="fab fa-whatsapp"></i>
                        <span>WhatsApp Agent</span>
                    </a>
                    <a href="settings.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 text-gray-700">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                </nav>
            </div>
            
            <!-- Logout Button -->
            <div class="absolute bottom-0 w-full p-6 border-t border-gray-100">
                <button onclick="logout()" class="sidebar-item flex items-center space-x-3 px-4 py-3 text-gray-700 w-full">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </button>
            </div>
        </div>
        
        <!-- ==================== MAIN CONTENT ==================== -->
        <div class="flex-1 ml-64 p-8 overflow-y-auto">
            <!-- Header -->
            <div class="mb-8">
                <h1 class="text-4xl font-bold text-gray-800 mb-2">Find Pulmonologists & Specialists</h1>
                <p class="text-gray-600 flex items-center">
                    <i class="fas fa-map-pin text-blue-600 mr-2"></i>
                    Discover top doctors near you in Kota
                </p>
            </div>
            
            <!-- Search Section -->
            <div class="bg-white rounded-2xl shadow-sm p-6 mb-8 border border-gray-100">
                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <!-- Location Input -->
                    <div class="relative">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-map-marker-alt text-blue-600 mr-1"></i> Your Location
                        </label>
                        <div class="relative">
                            <input type="text" id="location" 
                                   value="Kota, Rajasthan" 
                                   class="filter-input w-full pl-4 pr-10 py-3 border border-gray-200 rounded-xl focus:border-blue-500"
                                   placeholder="Enter city or area">
                            <button onclick="detectLocation()" 
                                    class="absolute right-2 top-1/2 -translate-y-1/2 bg-blue-600 text-white px-3 py-1 rounded-lg text-sm hover:bg-blue-700">
                                <i class="fas fa-location-dot mr-1"></i>Detect
                            </button>
                        </div>
                    </div>
                    
                    <!-- Radius Dropdown -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-expand-arrows-alt text-blue-600 mr-1"></i> Search Radius
                        </label>
                        <select id="radius" class="filter-input w-full px-4 py-3 border border-gray-200 rounded-xl">
                            <option value="5">Within 5 km</option>
                            <option value="10" selected>Within 10 km</option>
                            <option value="15">Within 15 km</option>
                            <option value="20">Within 20 km</option>
                            <option value="30">Within 30 km</option>
                            <option value="50">Within 50 km</option>
                        </select>
                    </div>
                    
                    <!-- Specialty Dropdown (Updated with All option) -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-stethoscope text-blue-600 mr-1"></i> Specialty
                        </label>
                        <select id="specialty" class="filter-input w-full px-4 py-3 border border-gray-200 rounded-xl">
                            <option value="all" selected>All Specialties</option>
                            <option value="Pulmonology">Pulmonology</option>
                            <option value="General Physician">General Physician</option>
                            <option value="Pediatrician">Pediatrician</option>
                            <option value="Surgeon">Surgeon</option>
                            <option value="Cardiologist">Cardiologist</option>
                            <option value="Orthopedic">Orthopedic</option>
                            <option value="ENT">ENT</option>
                            <option value="Ayurvedic">Ayurvedic</option>
                            <option value="Hospital">Hospital</option>
                        </select>
                    </div>
                    
                    <!-- Availability Dropdown -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-clock text-blue-600 mr-1"></i> Available
                        </label>
                        <select id="availability" class="filter-input w-full px-4 py-3 border border-gray-200 rounded-xl">
                            <option value="any">Any Time</option>
                            <option value="today">Today</option>
                            <option value="tomorrow">Tomorrow</option>
                            <option value="week">This Week</option>
                            <option value="weekend">Weekend</option>
                        </select>
                    </div>
                </div>
                
                <!-- Search Button -->
                <div class="mt-6 flex justify-end">
                    <button onclick="searchDoctors()" class="btn-primary flex items-center space-x-2">
                        <i class="fas fa-search"></i>
                        <span>Search Doctors</span>
                    </button>
                </div>
            </div>
            
            <!-- Map and Results Grid -->
            <div class="grid lg:grid-cols-3 gap-8">
                <!-- Map Section -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-2xl shadow-sm p-4 border border-gray-100">
                        <div id="doctorMap" style="height: 500px; width: 100%; border-radius: 16px;"></div>
                        
                        <!-- Map Controls -->
                        <div class="flex items-center justify-between mt-4">
                            <div class="flex items-center space-x-4">
                                <div class="flex items-center">
                                    <div class="w-3 h-3 bg-blue-600 rounded-full mr-2"></div>
                                    <span class="text-sm text-gray-600">Your Location</span>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-3 h-3 bg-red-500 rounded-full mr-2"></div>
                                    <span class="text-sm text-gray-600">Doctors</span>
                                </div>
                            </div>
                            <button onclick="expandRadius()" class="btn-secondary text-sm py-2 px-4">
                                <i class="fas fa-expand-alt mr-1"></i>Expand Radius
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Results Sidebar -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-2xl shadow-sm p-6 border border-gray-100 sticky top-4">
                        <!-- Results Header -->
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-xl font-bold text-gray-800">Results</h2>
                            <span class="bg-blue-100 text-blue-600 px-3 py-1 rounded-full text-sm font-semibold" id="resultCount">0</span>
                        </div>
                        
                        <!-- Search Info -->
                        <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-4 rounded-xl mb-4">
                            <p class="text-sm text-gray-700">
                                <i class="fas fa-search text-blue-600 mr-2"></i>
                                <span class="font-semibold">Searching in:</span><br>
                                <span id="searchLocation">Kota, Rajasthan</span><br>
                                <span id="searchRadius" class="text-blue-600">Within 10 km radius</span>
                            </p>
                        </div>
                        
                        <!-- Sort Options -->
                        <div class="mb-4">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                <i class="fas fa-sort-amount-down text-blue-600 mr-1"></i> Sort by:
                            </label>
                            <select id="sortBy" onchange="sortDoctors()" class="filter-input w-full px-3 py-2 border border-gray-200 rounded-xl">
                                <option value="distance">üìç Distance (Nearest First)</option>
                                <option value="rating">‚≠ê Highest Rated</option>
                                <option value="experience">üìÖ Most Experienced</option>
                                <option value="fee_low">üí∞ Fee: Low to High</option>
                                <option value="fee_high">üí∞ Fee: High to Low</option>
                            </select>
                        </div>
                        
                        <!-- Doctor List -->
                        <div id="doctorList" class="space-y-4 max-h-[600px] overflow-y-auto pr-2">
                            <!-- Doctors will be dynamically added here -->
                            <div class="text-center py-12">
                                <i class="fas fa-user-md text-5xl text-gray-300 mb-3"></i>
                                <p class="text-gray-500">Click "Search Doctors" to find specialists near you</p>
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="mt-4 space-y-2">
                            <button onclick="changeLocation()" class="btn-secondary w-full py-3">
                                <i class="fas fa-pencil-alt mr-2"></i>Change Location
                            </button>
                            <button onclick="resetFilters()" class="text-gray-500 hover:text-gray-700 text-sm w-full py-2">
                                <i class="fas fa-redo-alt mr-1"></i>Reset Filters
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Refine Results Section -->
            <div class="mt-8 bg-white rounded-2xl shadow-sm p-6 border border-gray-100">
                <h3 class="font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-sliders-h text-blue-600 mr-2"></i>
                    Refine Your Search
                </h3>
                <div class="flex flex-wrap gap-4">
                    <label class="flex items-center p-3 bg-gray-50 rounded-xl hover:bg-gray-100 cursor-pointer">
                        <input type="checkbox" class="w-4 h-4 text-blue-600 rounded">
                        <span class="ml-2 text-sm text-gray-700">Video Consultation</span>
                    </label>
                    <label class="flex items-center p-3 bg-gray-50 rounded-xl hover:bg-gray-100 cursor-pointer">
                        <input type="checkbox" class="w-4 h-4 text-blue-600 rounded">
                        <span class="ml-2 text-sm text-gray-700">Available Today</span>
                    </label>
                    <label class="flex items-center p-3 bg-gray-50 rounded-xl hover:bg-gray-100 cursor-pointer">
                        <input type="checkbox" class="w-4 h-4 text-blue-600 rounded">
                        <span class="ml-2 text-sm text-gray-700">Female Doctors</span>
                    </label>
                    <label class="flex items-center p-3 bg-gray-50 rounded-xl hover:bg-gray-100 cursor-pointer">
                        <input type="checkbox" class="w-4 h-4 text-blue-600 rounded">
                        <span class="ml-2 text-sm text-gray-700">Emergency Appointment</span>
                    </label>
                    <label class="flex items-center p-3 bg-gray-50 rounded-xl hover:bg-gray-100 cursor-pointer">
                        <input type="checkbox" class="w-4 h-4 text-blue-600 rounded">
                        <span class="ml-2 text-sm text-gray-700">24/7 Available</span>
                    </label>
                    <label class="flex items-center p-3 bg-gray-50 rounded-xl hover:bg-gray-100 cursor-pointer">
                        <input type="checkbox" class="w-4 h-4 text-blue-600 rounded">
                        <span class="ml-2 text-sm text-gray-700">Home Visit</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== JAVASCRIPT (Leaflet Map + Full Doctor Database) ==================== -->
    <script>
        // Global variables
        let map;
        let markers = [];
        let currentLocation = { lat: 25.1765, lng: 75.8451 }; // Default Kota coordinates
        let allDoctors = [];

        // ==================== COMPLETE DOCTOR DATABASE (Based on provided screenshots) ====================
        const doctorDatabase = [
            // Individual Doctors
            {
                id: 1,
                name: "Dr. Kapil Bhola",
                rating: 4.7,
                reviews: 116,
                qualification: "MBBS, MD",
                specialty: "General Physician",
                hospital: "Manash Hospital",
                area: "Talwandi, Kota",
                address: "HN 5B-15, Opposite Mahalaxmi Plaza, Near Allen Sammumat, Talwandi, Kota-Rajasthan-324005",
                experience: 21,
                timing: "Mon-Sat, 10:00 AM - 7:00 PM",
                lat: 25.1765,
                lng: 75.8451,
                fee: 500,
                available: "today",
                gender: "male",
                video: true,
                emergency: true,
                phone: "+91 8971742571",
                image: "üë®‚Äç‚öïÔ∏è"
            },
            {
                id: 2,
                name: "Dr. Ashok Kumar Tiwari",
                rating: 4.6,
                reviews: 22,
                qualification: "MBBS",
                specialty: "General Physician",
                hospital: "Tiwari Clinic",
                area: "Vigyan Nagar, Kota",
                address: "1 T I, Opposite Government Dispensary, Adarsh Block, Vigyan Nagar, Kota-Rajasthan-324005",
                experience: 40,
                timing: "Mon-Sat, 09:00 AM - 5:00 PM",
                lat: 25.1723,
                lng: 75.8489,
                fee: 300,
                available: "today",
                gender: "male",
                video: false,
                emergency: false,
                phone: "+91 8487964405",
                image: "üë®‚Äç‚öïÔ∏è"
            },
            {
                id: 3,
                name: "Dr. B L Gochar",
                rating: 4.3,
                reviews: 24,
                qualification: "MBBS, MS",
                specialty: "General Surgeon",
                hospital: "Anurag Hospital & Research Centre",
                area: "Mahaveer Nagar Extension, Kota",
                address: "7-C-34, Mahaveer Nagar, Mahaveer Nagar Extension, Kota-Rajasthan-324005",
                experience: 36,
                timing: "Mon-Sat, 09:00 AM - 8:00 PM",
                lat: 25.1698,
                lng: 75.8423,
                fee: 600,
                available: "today",
                gender: "male",
                video: true,
                emergency: true,
                phone: "+91 8490865700",
                image: "üë®‚Äç‚öïÔ∏è"
            },
            {
                id: 4,
                name: "Dr. Kuldeep Temani",
                rating: 5.0,
                reviews: 63,
                qualification: "MBBS",
                specialty: "General Physician",
                hospital: "Temani Clinic",
                area: "Shrinath Puram, Kota",
                address: "Balaji Market, Shrinath Puram, Kota",
                experience: 9,
                timing: "Mon-Sat, 08:00 AM - 8:00 PM",
                lat: 25.1690,
                lng: 75.8420,
                fee: 400,
                available: "today",
                gender: "male",
                video: false,
                emergency: false,
                phone: "+91 9829034567", // placeholder
                image: "üë®‚Äç‚öïÔ∏è"
            },
            {
                id: 5,
                name: "Dr. Sushil Soni",
                rating: 4.3,
                reviews: 67,
                qualification: "MBBS",
                specialty: "General Physician",
                hospital: "Soni Clinic",
                area: "Vigyan Nagar, Kota",
                address: "1 GH 24, Vigyan Nagar, Kota",
                experience: 30,
                timing: "Mon-Sat, 05:00 PM - 08:00 PM",
                lat: 25.1723,
                lng: 75.8489,
                fee: 300,
                available: "week",
                gender: "male",
                video: false,
                emergency: false,
                phone: "+91 9829045678",
                image: "üë®‚Äç‚öïÔ∏è"
            },
            {
                id: 6,
                name: "Dr. Samir Mehta",
                rating: 4.5,
                reviews: 50,
                qualification: "MBBS",
                specialty: "Pediatric Surgeon",
                hospital: "Mehta Nursing Home",
                area: "Kota City",
                address: "124/139, Vallabh Bari, Kota",
                experience: 25,
                timing: "Mon-Sat, 10:00 AM - 01:00 PM, 05:00 PM - 07:00 PM",
                lat: 25.1700,
                lng: 75.8400,
                fee: 500,
                available: "today",
                gender: "male",
                video: true,
                emergency: true,
                phone: "+91 9829056789",
                image: "üë®‚Äç‚öïÔ∏è"
            },
            {
                id: 7,
                name: "Dr. Anil Saxena",
                rating: 4.2,
                reviews: 18,
                qualification: "M.D. Medicine",
                specialty: "General Physician",
                hospital: "Saxena Clinic",
                area: "Kota City",
                address: "Kota City",
                experience: 50,
                timing: "Mon-Sat, 06:00 PM - 08:00 PM",
                lat: 25.1700,
                lng: 75.8400,
                fee: 100,
                available: "week",
                gender: "male",
                video: false,
                emergency: false,
                phone: "+91 9829067890",
                image: "üë®‚Äç‚öïÔ∏è"
            },
            {
                id: 8,
                name: "Dr. Manoj Seval",
                rating: 4.0,
                reviews: 10,
                qualification: "MBBS",
                specialty: "General Physician",
                hospital: "Seva Clinic",
                area: "Kota City",
                address: "Kota City",
                experience: 7,
                timing: "Mon-Sat, 09:00 AM - 08:00 PM",
                lat: 25.1700,
                lng: 75.8400,
                fee: 200,
                available: "today",
                gender: "male",
                video: false,
                emergency: false,
                phone: "+91 9829078901",
                image: "üë®‚Äç‚öïÔ∏è"
            },
            {
                id: 9,
                name: "Dr. Rahul Kumawat",
                rating: 4.0,
                reviews: 5,
                qualification: "MBBS",
                specialty: "General Physician",
                hospital: "Dr Rahul Clinic",
                area: "Kota City",
                address: "Kota City",
                experience: 4,
                timing: "Mon-Sat, 09:00 AM - 08:00 PM",
                lat: 25.1700,
                lng: 75.8400,
                fee: 200,
                available: "today",
                gender: "male",
                video: false,
                emergency: false,
                phone: "+91 9829089012",
                image: "üë®‚Äç‚öïÔ∏è"
            },
            {
                id: 10,
                name: "Dr. Priyanka Upadhyay",
                rating: 4.5,
                reviews: 15,
                qualification: "MBBS",
                specialty: "General Physician",
                hospital: "Dr Priyanka Upadhyay's Clinic",
                area: "Kota City",
                address: "Kota City",
                experience: 10,
                timing: "Mon-Sat, 09:00 AM - 08:00 PM",
                lat: 25.1700,
                lng: 75.8400,
                fee: 200,
                available: "today",
                gender: "female",
                video: true,
                emergency: false,
                phone: "+91 9829090123",
                image: "üë©‚Äç‚öïÔ∏è"
            },
            {
                id: 11,
                name: "Dr. Shivansh Gautam",
                rating: 4.0,
                reviews: 3,
                qualification: "MBBS",
                specialty: "General Physician",
                hospital: "Dr.Shavansh Gautam Clinic",
                area: "Kota City",
                address: "Kota City",
                experience: 4,
                timing: "Mon-Sat, 09:00 AM - 08:00 PM",
                lat: 25.1700,
                lng: 75.8400,
                fee: 100,
                available: "today",
                gender: "male",
                video: false,
                emergency: false,
                phone: "+91 9829101234",
                image: "üë®‚Äç‚öïÔ∏è"
            },
            {
                id: 12,
                name: "Dr. Zia Rehman Khan",
                rating: 4.0,
                reviews: 7,
                qualification: "MBBS",
                specialty: "General Physician",
                hospital: "Bharat Nursing Home",
                area: "Kotari Gordhanpura",
                address: "Kotari Gordhanpura, Kota",
                experience: 11,
                timing: "Mon-Sat, 09:00 AM - 08:00 PM",
                lat: 25.1500,
                lng: 75.8300,
                fee: 100,
                available: "today",
                gender: "male",
                video: false,
                emergency: false,
                phone: "+91 9829112345",
                image: "üë®‚Äç‚öïÔ∏è"
            },
            {
                id: 13,
                name: "Dr. Jasvinder Singh",
                rating: 4.2,
                reviews: 20,
                qualification: "MBBS",
                specialty: "General Physician",
                hospital: "Sukhmani Physiotherapy Centre",
                area: "Dadabari, Kota",
                address: "4-A, Alfa Complex, Aditya Awas Road, Bajrang Nagar, Dadabari, Kota",
                experience: 20,
                timing: "Mon-Sun, 06:00 AM - 09:00 PM",
                lat: 25.1587,
                lng: 75.8523,
                fee: 500,
                available: "today",
                gender: "male",
                video: false,
                emergency: false,
                phone: "+91 1140036578 ext 574",
                image: "üë®‚Äç‚öïÔ∏è"
            },
            // Hospitals & Multi-specialty Centers
            {
                id: 14,
                name: "Manipal Hospital",
                rating: 4.3,
                reviews: 28,
                qualification: "Multi-specialty Hospital",
                specialty: "Hospital",
                hospital: "Manipal Hospital",
                area: "Mahaveer Nagar, Kota",
                address: "Mahaveer Nagar, Kota",
                experience: 15,
                timing: "Open 24 Hrs",
                lat: 25.1698,
                lng: 75.8423,
                fee: 500,
                available: "today",
                gender: "neutral",
                video: true,
                emergency: true,
                phone: "+91 7490052928",
                image: "üè•"
            },
            {
                id: 15,
                name: "Jindal Endo Laparoscopic Hospital",
                rating: 4.9,
                reviews: 1366,
                qualification: "Multi-specialty Hospital",
                specialty: "Hospital",
                hospital: "Jindal Endo Laparoscopic Hospital",
                area: "Talwandi, Kota",
                address: "Jindal Endo Laparoscopic Hospital, Talwandi, Kota",
                experience: 19,
                timing: "Open 24 Hrs",
                lat: 25.1765,
                lng: 75.8451,
                fee: 600,
                available: "today",
                gender: "neutral",
                video: true,
                emergency: true,
                phone: "+91 8488035023",
                image: "üè•"
            },
            {
                id: 16,
                name: "Shiv Shakti Hospital",
                rating: 4.4,
                reviews: 456,
                qualification: "Multi-specialty Hospital",
                specialty: "Hospital",
                hospital: "Shiv Shakti Hospital",
                area: "Borkheda, Kota",
                address: "80 Feet Link Road, Borkheda, Kota",
                experience: 6,
                timing: "Open 24 Hrs",
                lat: 25.1600,
                lng: 75.8200,
                fee: 400,
                available: "today",
                gender: "neutral",
                video: true,
                emergency: true,
                phone: "+91 8128272957",
                image: "üè•"
            },
            {
                id: 17,
                name: "Sushrut Hospital",
                rating: 4.5,
                reviews: 354,
                qualification: "Multi-specialty Hospital",
                specialty: "Hospital",
                hospital: "Sushrut Hospital",
                area: "Vigyan Nagar, Kota",
                address: "Jhalawar Road, Vigyan Nagar, Kota",
                experience: 10,
                timing: "Open 24 Hrs",
                lat: 25.1723,
                lng: 75.8489,
                fee: 500,
                available: "today",
                gender: "neutral",
                video: true,
                emergency: true,
                phone: "+91 7490021289",
                image: "üè•"
            },
            {
                id: 18,
                name: "Shuddhi Hiims Ayurvedic Clinics and Hospitals",
                rating: 5.0,
                reviews: 328,
                qualification: "Ayurvedic Hospital",
                specialty: "Ayurvedic",
                hospital: "Shuddhi Hiims",
                area: "Talwandi, Kota",
                address: "Sheila Choudhary Road, Talwandi, Kota",
                experience: 8,
                timing: "Open 24 Hrs",
                lat: 25.1765,
                lng: 75.8451,
                fee: 400,
                available: "today",
                gender: "neutral",
                video: true,
                emergency: false,
                phone: "+91 8460214275",
                image: "üè•"
            },
            {
                id: 19,
                name: "Kota Trauma Hospital & Arshi Fertility IVF & Research Centre",
                rating: 4.9,
                reviews: 296,
                qualification: "Multi-specialty Hospital",
                specialty: "Hospital",
                hospital: "Kota Trauma Hospital",
                area: "Chambal Vikas, Kota",
                address: "CAD ‚Äì CHAMBAL GARDEN ROAD, Chambal Vikas, Kota",
                experience: 27,
                timing: "Open 24 Hrs",
                lat: 25.1550,
                lng: 75.8250,
                fee: 600,
                available: "today",
                gender: "neutral",
                video: true,
                emergency: true,
                phone: "+91 9829123456",
                image: "üè•"
            },
            {
                id: 20,
                name: "Kinker Hospital",
                rating: 4.4,
                reviews: 21,
                qualification: "Multi-specialty Hospital",
                specialty: "Hospital",
                hospital: "Kinker Hospital",
                area: "Talwandi, Kota",
                address: "Jhalawar Road, Talwandi, Kota",
                experience: 33,
                timing: "Open 24 Hrs",
                lat: 25.1765,
                lng: 75.8451,
                fee: 500,
                available: "today",
                gender: "neutral",
                video: false,
                emergency: true,
                phone: "+91 9829134567",
                image: "üè•"
            },
            {
                id: 21,
                name: "Luv Kush Nursing Home",
                rating: 4.9,
                reviews: 1003,
                qualification: "Nursing Home",
                specialty: "Hospital",
                hospital: "Luv Kush Nursing Home",
                area: "Kunadi, Kota",
                address: "Keshorai Patan Road, Kunadi, Kota",
                experience: 14,
                timing: "Open 24 Hrs",
                lat: 25.1634,
                lng: 75.8312,
                fee: 400,
                available: "today",
                gender: "neutral",
                video: true,
                emergency: true,
                phone: "+91 8485972801",
                image: "üè•"
            },
            {
                id: 22,
                name: "Dhakar Hospital",
                rating: 4.3,
                reviews: 205,
                qualification: "Multi-specialty Hospital",
                specialty: "Hospital",
                hospital: "Dhakar Hospital",
                area: "Kunadi, Kota",
                address: "Main Road, Kunadi, Kota",
                experience: 8,
                timing: "Open 24 Hrs",
                lat: 25.1634,
                lng: 75.8312,
                fee: 400,
                available: "today",
                gender: "neutral",
                video: false,
                emergency: true,
                phone: "+91 9829145678",
                image: "üè•"
            },
            {
                id: 23,
                name: "Shri Hari Hospital",
                rating: 3.6,
                reviews: 222,
                qualification: "Multi-specialty Hospital",
                specialty: "Hospital",
                hospital: "Shri Hari Hospital",
                area: "Kunadi, Kota",
                address: "Bundi Road, Kunadi, Kota",
                experience: 14,
                timing: "Open 24 Hrs",
                lat: 25.1634,
                lng: 75.8312,
                fee: 350,
                available: "today",
                gender: "neutral",
                video: false,
                emergency: true,
                phone: "+91 9008349599",
                image: "üè•"
            },
            {
                id: 24,
                name: "Acharya Children Hospital",
                rating: 3.4,
                reviews: 82,
                qualification: "Children Hospital",
                specialty: "Pediatrician",
                hospital: "Acharya Children Hospital",
                area: "Jawahar Nagar, Kota",
                address: "Main Road, Jawahar Nagar, Kota",
                experience: 20,
                timing: "Open 24 Hrs",
                lat: 25.1800,
                lng: 75.8600,
                fee: 400,
                available: "today",
                gender: "neutral",
                video: false,
                emergency: true,
                phone: "+91 8460427112",
                image: "üè•"
            },
            {
                id: 25,
                name: "Kota Heart Institute & Multi Speciality Hospital",
                rating: 3.2,
                reviews: 556,
                qualification: "Multi-specialty Hospital",
                specialty: "Cardiology",
                hospital: "Kota Heart Institute",
                area: "Talwandi, Kota",
                address: "10 A, Near Vigyaan Nagar Flyover, Talwandi, Kota",
                experience: 18,
                timing: "Open 24 Hrs",
                lat: 25.1765,
                lng: 75.8451,
                fee: 500,
                available: "today",
                gender: "neutral",
                video: true,
                emergency: true,
                phone: "+91 9829156789",
                image: "üè•"
            },
            {
                id: 26,
                name: "Jaiswal Hospital and Neuro Institute",
                rating: 4.6,
                reviews: 850,
                qualification: "Neuro & Multi-specialty",
                specialty: "Neurology",
                hospital: "Jaiswal Hospital",
                area: "Vigyan Nagar, Kota",
                address: "Jhalawar Road, Vigyan Nagar, Kota",
                experience: 28,
                timing: "Open 24 Hrs",
                lat: 25.1723,
                lng: 75.8489,
                fee: 600,
                available: "today",
                gender: "neutral",
                video: true,
                emergency: true,
                phone: "+91 9829167890",
                image: "üè•"
            }
        ];

        // Initialize everything when page loads
        window.onload = function() {
            checkLogin();
            initMap();
            loadDoctors();
        };

        // Check if user is logged in
        function checkLogin() {
            const user = JSON.parse(localStorage.getItem('user'));
            if (!user) {
                window.location.href = 'login.html';
                return;
            }
            document.getElementById('userName').textContent = user.firstName + ' ' + user.lastName;
        }

        // Initialize Leaflet Map
        function initMap() {
            map = L.map('doctorMap').setView([currentLocation.lat, currentLocation.lng], 13);

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(map);

            // Add user marker (blue dot)
            L.marker([currentLocation.lat, currentLocation.lng], {
                icon: L.divIcon({
                    className: 'user-marker',
                    html: '<div style="background-color: #2563eb; width: 20px; height: 20px; border-radius: 50%; border: 3px solid white;"></div>',
                    iconSize: [20, 20]
                })
            }).addTo(map).bindPopup('Your Location');

            // Add search radius circle (default 10 km)
            L.circle([currentLocation.lat, currentLocation.lng], {
                color: '#2563eb',
                fillColor: '#2563eb',
                fillOpacity: 0.1,
                radius: 10000
            }).addTo(map);
            userMarker = L.marker([currentLocation.lat, currentLocation.lng], {
                icon: L.divIcon({
                className: 'user-marker',
                html: '<div style="background-color: #2563eb; width: 20px; height: 20px; border-radius: 50%; border: 3px solid white;"></div>',
                iconSize: [20, 20]
                })
            }).addTo(map).bindPopup('Your Location');
        }

        // Load and display doctors
        function loadDoctors() {
            allDoctors = [...doctorDatabase];
            displayDoctors(allDoctors);
            addDoctorMarkers(allDoctors);
            updateResultCount(allDoctors.length);
        }

        // Add doctor markers on map
        function addDoctorMarkers(doctors) {
            // Clear existing markers
            markers.forEach(marker => map.removeLayer(marker));
            markers = [];

            doctors.forEach(doctor => {
                const marker = L.marker([doctor.lat, doctor.lng]).addTo(map);
                marker.bindPopup(`
                    <div style="min-width: 200px;">
                        <h3 style="font-weight: bold;">${doctor.name}</h3>
                        <p>${doctor.specialty} | ‚≠ê ${doctor.rating} (${doctor.reviews} reviews)</p>
                        <p>üè• ${doctor.hospital}</p>
                        <p>üí∞ ‚Çπ${doctor.fee}</p>
                        <button onclick="bookDoctor(${doctor.id})" 
                                style="background-color: #2563eb; color: white; border: none; padding: 5px 10px; border-radius: 5px; width: 100%; margin-top: 10px;">
                            Book Appointment
                        </button>
                    </div>
                `);
                markers.push(marker);
            });
        }

        // Display doctors in sidebar
        function displayDoctors(doctors) {
            const doctorList = document.getElementById('doctorList');

            if (doctors.length === 0) {
                doctorList.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-user-md text-5xl text-gray-300 mb-3"></i>
                        <p class="text-gray-500 font-medium">No doctors found</p>
                        <p class="text-sm text-gray-400 mt-2">Try expanding your search radius</p>
                    </div>
                `;
                return;
            }

            let html = '';
            doctors.forEach(doctor => {
                // Simulate distance for display (in real app calculate from currentLocation)
                const distance = (Math.random() * 5 + 1).toFixed(1);
                
                html += `
                    <div class="doctor-card cursor-pointer" onclick="focusDoctor(${doctor.id})">
                        <div class="flex items-start space-x-4">
                            <div class="doctor-avatar">
                                <span class="text-2xl">${doctor.image}</span>
                            </div>
                            <div class="flex-1">
                                <div class="flex justify-between items-start">
                                    <h3 class="font-bold text-gray-800">${doctor.name}</h3>
                                    <span class="bg-green-100 text-green-600 text-xs px-2 py-1 rounded-full">${distance} km</span>
                                </div>
                                <div class="flex items-center mt-1">
                                    <i class="fas fa-star text-yellow-400 text-sm mr-1"></i>
                                    <span class="font-semibold text-sm">${doctor.rating}</span>
                                    <span class="text-xs text-gray-500 ml-1">(${doctor.reviews})</span>
                                </div>
                                <p class="text-sm text-gray-700 mt-2">${doctor.specialty}</p>
                                <p class="text-xs text-gray-600">${doctor.qualification}</p>
                                <p class="text-xs text-gray-600 mt-1">
                                    <i class="fas fa-map-marker-alt text-blue-600 mr-1"></i>${doctor.area}
                                </p>
                                <p class="text-xs text-gray-600">
                                    <i class="fas fa-clock text-blue-600 mr-1"></i>${doctor.timing}
                                </p>
                                <div class="flex justify-between items-center mt-3">
                                    <span class="font-bold text-blue-600">‚Çπ${doctor.fee}</span>
                                    <button onclick="bookDoctor(${doctor.id})" 
                                            class="bg-blue-600 text-white px-4 py-1 rounded-full text-xs hover:bg-blue-700">
                                        Book
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });

            doctorList.innerHTML = html;
            updateResultCount(doctors.length);
        }

        // Search doctors based on filters
        function searchDoctors() {
            const location = document.getElementById('location').value;
            const radius = parseInt(document.getElementById('radius').value);
            const specialty = document.getElementById('specialty').value;
            const availability = document.getElementById('availability').value;

            // Update search info
            document.getElementById('searchLocation').textContent = location || 'Kota, Rajasthan';
            document.getElementById('searchRadius').textContent = `Within ${radius} km radius`;

            // Filter doctors
            let filtered = [...doctorDatabase];

            // Filter by specialty (if not "all")
            if (specialty !== 'all') {
                filtered = filtered.filter(d => d.specialty.toLowerCase().includes(specialty.toLowerCase()));
            }

            // Filter by availability (simplified)
            if (availability !== 'any') {
                filtered = filtered.filter(d => d.available === availability);
            }

            // TODO: filter by actual distance using radius (requires geolocation)
            // For demo, we just show all within radius assumption

            displayDoctors(filtered);
            addDoctorMarkers(filtered);
        }

        // Detect user's current location
        function detectLocation() {
            if (navigator.geolocation) {
                document.getElementById('location').value = 'Detecting...';

                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        currentLocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };

                        map.setView([currentLocation.lat, currentLocation.lng], 14);
                        document.getElementById('location').value = 'Current Location';
                        searchDoctors();
                    },
                    (error) => {
                        alert('Unable to detect location. Please enter manually.');
                        document.getElementById('location').value = 'Kota, Rajasthan';
                    }
                );
            } else {
                alert('Geolocation is not supported by your browser');
            }
        }

        // Sort doctors
        function sortDoctors() {
            const sortBy = document.getElementById('sortBy').value;
            let sorted = [...allDoctors];

            switch(sortBy) {
                case 'rating':
                    sorted.sort((a, b) => b.rating - a.rating);
                    break;
                case 'experience':
                    sorted.sort((a, b) => b.experience - a.experience);
                    break;
                case 'fee_low':
                    sorted.sort((a, b) => a.fee - b.fee);
                    break;
                case 'fee_high':
                    sorted.sort((a, b) => b.fee - a.fee);
                    break;
                default:
                    // distance - keep original order for demo
                    break;
            }

            displayDoctors(sorted);
            addDoctorMarkers(sorted);
        }

        // Focus on doctor on map
        function focusDoctor(doctorId) {
            const doctor = allDoctors.find(d => d.id === doctorId);
            if (doctor) {
                map.setView([doctor.lat, doctor.lng], 16);
            }
        }

        // Book appointment
        function bookDoctor(doctorId) {
            const doctor = allDoctors.find(d => d.id === doctorId);
            if (doctor) {
                if (confirm(`Book appointment with ${doctor.name}?\nFee: ‚Çπ${doctor.fee}\n\nClick OK to proceed.`)) {
                    alert('Appointment request sent! Doctor will contact you shortly.');
                }
            }
        }

        // Expand search radius
        function expandRadius() {
            const radiusSelect = document.getElementById('radius');
            const currentValue = parseInt(radiusSelect.value);

            if (currentValue < 50) {
                radiusSelect.value = currentValue + 10;
                searchDoctors();
            }
        }

        // Change location
        function changeLocation() {
            document.getElementById('location').value = '';
            document.getElementById('location').focus();
        }

        // Reset all filters
        function resetFilters() {
            document.getElementById('location').value = 'Kota, Rajasthan';
            document.getElementById('radius').value = '10';
            document.getElementById('specialty').value = 'all';
            document.getElementById('availability').value = 'any';
            document.getElementById('sortBy').value = 'distance';

            currentLocation = { lat: 25.1765, lng: 75.8451 };
            map.setView([currentLocation.lat, currentLocation.lng], 13);
            loadDoctors();
        }

        // Update result count
        function updateResultCount(count) {
            document.getElementById('resultCount').textContent = count + ' doctors found';
        }

        // Logout function
        function logout() {
            localStorage.removeItem('user');
            window.location.href = 'login.html';
        }
    </script>
</body>
</html>